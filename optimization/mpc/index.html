<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://meyerv11045.github.com/machine-learning/optimization/mpc/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Model Predictive Control - ML Notebook</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">ML Notebook</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Machine Learning <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../machine_learning/supervised_learning/" class="dropdown-item">Supervised Learning</a>
</li>
                                    
<li>
    <a href="../../machine_learning/regression/" class="dropdown-item">Regression</a>
</li>
                                    
<li>
    <a href="../../machine_learning/classification/" class="dropdown-item">Classification</a>
</li>
                                    
<li>
    <a href="../../machine_learning/optimization/" class="dropdown-item">Optimization Techniques</a>
</li>
                                    
<li>
    <a href="../../machine_learning/feature_scaling/" class="dropdown-item">Feature Scaling</a>
</li>
                                    
<li>
    <a href="../../machine_learning/model_selection/" class="dropdown-item">Model Selection</a>
</li>
                                    
<li>
    <a href="../../machine_learning/reinforcement_learning/" class="dropdown-item">Reinforcement Learning</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Neural Networks <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../machine_learning/nn/activation_functions/" class="dropdown-item">Activation Functions</a>
</li>
                                    
<li>
    <a href="../../machine_learning/nn/pytorch/" class="dropdown-item">PyTorch</a>
</li>
                                    
<li>
    <a href="../../machine_learning/nn/auto_encoders/" class="dropdown-item">AutoEncoders</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Optimization <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../overview/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../convergence/" class="dropdown-item">Convergence</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Root Finding methods</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../root-methods/newtons/" class="dropdown-item">Newtons Method</a>
</li>
            
<li>
    <a href="../root-methods/secant/" class="dropdown-item">Secant Method</a>
</li>
            
<li>
    <a href="../root-methods/bisection/" class="dropdown-item">Bisection</a>
</li>
            
<li>
    <a href="../root-methods/regula_falsi/" class="dropdown-item">Regula Falsi</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="./" class="dropdown-item active">Model Predictive Control</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../root-methods/regula_falsi/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#model-predictive-control" class="nav-link">Model Predictive Control</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#explicit-mpc" class="nav-link">Explicit MPC</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#optimality" class="nav-link">Optimality:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#recursive-feasability" class="nav-link">Recursive Feasability:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="model-predictive-control">Model Predictive Control</h1>
<ul>
<li>Relies on a dynamic model to make predictions for future values of the controlled variables of the system. </li>
<li>It then solves a contrained optimization problem to calculate the optimal control action that minimizes the difference between the predicted controlled values and the desired/set control values.</li>
<li>Main limitation: High computational cost since this optimization problem must be solved at each time step  <ul>
<li>The computational cost increases even more as the time horizon over which to predict future control values increases.</li>
<li>The computational cost becomes intractable to run realtime as the number of states and contraints grows (NN approximation could fix this)</li>
<li>Explicit MPC (eMPC) and learning-based NN approaches have been proposed to overcome this</li>
</ul>
</li>
<li>Takes on many forms: one-norm, infinite norm, PWA model, tracking</li>
</ul>
<h2 id="explicit-mpc">Explicit MPC</h2>
<ul>
<li>Goal is to rewrite the optimization problem as a multi-parametric quadtratic programming (mpQP)</li>
<li>This is possible for linear systems but cannot be extended to nonlinear systems</li>
<li>An explicit solution to the mpQP has been demonstrated and it is of the form of a PWA function</li>
<li>The PWA function defined over the state space will act as a fast prediction/lookup function for control policies given a input state meaning there is no need to solve the optimization problem online!<ul>
<li>This result was achieved by Bemporad et al. (2002)</li>
</ul>
</li>
<li>Resources: (<a href="http://www.bcamath.org/documentos_public/archivos/actividades_cientificas/TalkNUMERIWAVES20130412TP.pdf">Brief mention</a>)</li>
</ul>
<h2 id="optimality">Optimality:</h2>
<ul>
<li>Not always feasible to run the optimization process to complete convergence for the most optimal control output (especially when running online) </li>
<li>Therefore, optimality is sometimes relaxed to only require a sufficient decrease in the cost/objective function<ul>
<li>Then the optimization problem would be terminated at a feasible but sub-optimal stage</li>
</ul>
</li>
</ul>
<h2 id="recursive-feasability">Recursive Feasability:</h2>
<ul>
<li>MPC controllers are not gauranteed to be stabilizing (linear quadratic control is gauranted to be stabilizing)<ul>
<li>Stability must be built in when defining the optimization problem</li>
</ul>
</li>
<li>The optimization problemâ€™s feasbility can be lost when the state is driven to a region in which the optimization problem has no solution</li>
<li>typical approach to solve this is to append constrainst to the optimization problem to guarantee that loss of feasability cannot occur (that is what was done in the papers I have read so far)<ul>
<li>When this is done, an MPC controller is said to be recursively feasible meaning it cannot put the state in a place with no solution to the optimization problem</li>
</ul>
</li>
<li>Constructing an MPC controller with the theoretical (a-priori) guarantee of recursive feasability is not always desirable or easy to do</li>
<li>Sometimes we might have a situation where given an MPC controller and the goal is to determine if it is recursively feasbile<ul>
<li>The goal is primarly to invalidate the controller by detecting problematic states where the recursive feasability is lost </li>
<li>Second objective is to find certificates of guaranteed recursive feasability</li>
</ul>
</li>
<li>DEF: The MPC controller is recursively feasible if and only if for all ini- tially feasible x0 and for all optimal sequences of control inputs the MPC optimization problem remains feasible for all time. </li>
<li>DEF: The MPC controller is strongly recursively feasible if and only if for all initially feasible x0 and for all sequences of feasible control inputs the MPC optimization problem remains feasible for all time. </li>
<li><a href="https://users.isy.liu.se/johanl/2011_AUT_OOPS.pdf">Resource</a> (analysis tool for determining recursive feasability of an MPC controller)</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
